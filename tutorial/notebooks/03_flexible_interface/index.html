
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="ie=edge" http-equiv="x-ua-compatible"/>
<link href="https://mackelab.org/sbi/tutorial/notebooks/03_flexible_interface/" rel="canonical"/>
<meta content="Copy to clipboard" name="lang:clipboard.copy"/>
<meta content="Copied to clipboard" name="lang:clipboard.copied"/>
<meta content="en" name="lang:search.language"/>
<meta content="True" name="lang:search.pipeline.stopwords"/>
<meta content="True" name="lang:search.pipeline.trimmer"/>
<meta content="No matching documents" name="lang:search.result.none"/>
<meta content="1 matching document" name="lang:search.result.one"/>
<meta content="# matching documents" name="lang:search.result.other"/>
<meta content="[\s\-]+" name="lang:search.tokenizer"/>
<link href="../../../assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.1, mkdocs-material-4.6.3" name="generator"/>
<title>03 flexible interface - sbi</title>
<link href="../../../assets/stylesheets/application.adb8469c.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/application-palette.a8b3c06d.css" rel="stylesheet"/>
<meta content="#3f51b5" name="theme-color"/>
<script src="../../../assets/javascripts/modernizr.86422ebf.js"></script>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
<link href="../../../assets/fonts/material-icons.css" rel="stylesheet"/>
<link href="../../../static/global.css" rel="stylesheet"/>
<link href="../../../css/ansi-colours.css" rel="stylesheet"/>
<link href="../../../css/jupyter-cells.css" rel="stylesheet"/>
<link href="../../../css/pandas-dataframe.css" rel="stylesheet"/>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" dir="ltr">
<svg class="md-svg">
<defs>
<svg height="448" id="__github" viewbox="0 0 416 448" width="416" xmlns="http://www.w3.org/2000/svg"><path d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z" fill="currentColor"></path></svg>
</defs>
</svg>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<a class="md-skip" href="#the-flexible-interface" tabindex="0">
        Skip to content
      </a>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a aria-label="sbi" class="md-header-nav__button md-logo" href="https://mackelab.org/sbi/" title="sbi">
<img alt="logo" height="24" src="../../../static/logo.svg" width="24"/>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
              sbi
            </span>
<span class="md-header-nav__topic">
              
                03 flexible interface
              
            </span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-icon md-search__icon" for="__search"></label>
<button class="md-icon md-search__icon" data-md-component="reset" tabindex="-1" type="reset">
        
      </button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="result">
<div class="md-search-result__meta">
            Type to start searching
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<div class="md-header-nav__source">
<a class="md-source" data-md-source="github" href="http://github.com/mackelab/sbi/" title="Go to repository">
<div class="md-source__icon">
<svg height="24" viewbox="0 0 24 24" width="24">
<use height="24" width="24" xlink:href="#__github"></use>
</svg>
</div>
<div class="md-source__repository">
    mackelab/sbi
  </div>
</a>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container">
<main class="md-main" role="main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title md-nav__title--site" for="__drawer">
<a class="md-nav__button md-logo" href="https://mackelab.org/sbi/" title="sbi">
<img alt="logo" height="48" src="../../../static/logo.svg" width="48"/>
</a>
    sbi
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-source="github" href="http://github.com/mackelab/sbi/" title="Go to repository">
<div class="md-source__icon">
<svg height="24" viewbox="0 0 24 24" width="24">
<use height="24" width="24" xlink:href="#__github"></use>
</svg>
</div>
<div class="md-source__repository">
    mackelab/sbi
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../.." title="Home">
      Home
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../install/" title="Installation">
      Installation
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" id="nav-3" type="checkbox"/>
<label class="md-nav__link" for="nav-3">
      Tutorial
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-3">
        Tutorial
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../markdown_files/00_getting_started/" title="Getting started">
      Getting started
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../markdown_files/01_gaussian_amortized/" title="Amortized inference">
      Amortized inference
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../markdown_files/02_HH_simulator/" title="Hodgkin-Huxley example">
      Hodgkin-Huxley example
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../markdown_files/03_flexible_interface/" title="Flexible interface">
      Flexible interface
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../contribute/" title="Contribute">
      Contribute
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../reference/" title="API Reference">
      API Reference
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../credits/" title="Credits">
      Credits
    </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#features">
    Features
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#linear-gaussian-example">
    Linear Gaussian example
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<a class="md-icon md-content__icon" href="http://github.com/mackelab/sbi/edit/master/docs/tutorial/notebooks/03_flexible_interface.ipynb" title="Edit this page"></a>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script>
(function() {
  function addWidgetsRenderer() {
    var mimeElement = document.querySelector('script[type="application/vnd.jupyter.widget-view+json"]');
    var scriptElement = document.createElement('script');
    var widgetRendererSrc = 'https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js';
    var widgetState;

    // Fallback for older version:
    try {
      widgetState = mimeElement && JSON.parse(mimeElement.innerHTML);

      if (widgetState && (widgetState.version_major < 2 || !widgetState.version_major)) {
        widgetRendererSrc = 'jupyter-js-widgets@*/dist/embed.js';
      }
    } catch(e) {}

    scriptElement.src = widgetRendererSrc;
    document.body.appendChild(scriptElement);
  }

  document.addEventListener('DOMContentLoaded', addWidgetsRenderer);
}());
</script>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></div></div></p>
<h1 id="the-flexible-interface">The flexible interface<a class="headerlink" href="#the-flexible-interface" title="Permanent link">¶</a></h1>
<p>In the previous tutorial, we have demonstrated how <code>sbi</code> can be used to run simulation-based inference with just a single line of code.</p>
<p>In addition to this simple interface, <code>sbi</code> also provides a <strong>flexible interface</strong> which unlocks several additional features implemented in <code>sbi</code>.
</p></div>
</article></div></div></main></div></body></html>

<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></div></div></p>
<h2 id="features">Features<a class="headerlink" href="#features" title="Permanent link">¶</a></h2>
<p>The flexible interface allows you to customize the following:</p>
<ul>
<li>performing sequential posterior estimation by using <code>num_rounds&gt;1</code>. This can decrease the number of simulations one has to run, but the inference procedure is no longer amortized.  </li>
<li>specify your own density estimator, or change hyperparameters of existing ones (e.g. number of hidden units for <a href="https://arxiv.org/abs/1906.04032">NSF</a>).</li>
<li>run simulations in batches, which can speed up simulations.</li>
<li>when it makes sense, choose between different methods to sample from the posterior.</li>
<li>use calibration kernels as proposed by <a href="https://arxiv.org/abs/1711.01861">Lueckmann, Goncalves et al. 2017</a>.
</li></ul></div>



<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1"></div></div></p>
<h2 id="linear-gaussian-example">Linear Gaussian example<a class="headerlink" href="#linear-gaussian-example" title="Permanent link">¶</a></h2>
<p></p></div>


<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="kn">from</span> <span class="nn">sbi.inference</span> <span class="kn">import</span> <span class="n">SNPE</span><span class="p">,</span> <span class="n">prepare_for_sbi</span>
<span class="kn">from</span> <span class="nn">sbi.utils.get_nn_models</span> <span class="kn">import</span> <span class="n">posterior_nn</span>
<span class="kn">import</span> <span class="nn">sbi.utils</span> <span class="k">as</span> <span class="nn">utils</span>
</code></pre></div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
We will show an example of how we can use the flexible interface to infer the posterior for an example with a Gaussian likelihood (same example as before). After importing the inference method we want, <code>SNPE</code>, a function to prepare the input <code>prepare_for_sbi</code> and a factory for density estimators <code>posterior_nn</code> above, we define the simulator and prior:
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="codehilite"><pre><span></span><code><span class="n">num_dim</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">prior</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">BoxUniform</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="mi">2</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_dim</span><span class="p">),</span> 
                         <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_dim</span><span class="p">))</span>
</code></pre></div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">linear_gaussian</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">theta</span> <span class="o">+</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span>
</code></pre></div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
In the advanced mode, you have to ensure that your simulator and prior adhere the requirements of <code>sbi</code>. You can do so with the <code>prepare_for_sbi()</code> function. In addition <code>prepare_for_sbi()</code> returns the <code>x_shape</code>, which is the shape of a single simulation output.
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="codehilite"><pre><span></span><code><span class="n">simulator</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">x_shape</span> <span class="o">=</span> <span class="n">prepare_for_sbi</span><span class="p">(</span><span class="n">linear_gaussian</span><span class="p">,</span> <span class="n">prior</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
You can specify a custom density estimator. Since we use S*N*PE, we specifiy a neural network targeting the <em>posterior</em> (hence the call to <code>posterior_nn()</code>). In this example, we will create a neural spline flow (<code>'nsf'</code>) with <code>60</code> hidden units and <code>3</code> transform layers:
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="codehilite"><pre><span></span><code><span class="n">my_density_estimator</span> <span class="o">=</span> <span class="n">posterior_nn</span><span class="p">(</span><span class="s1">'nsf'</span><span class="p">,</span> <span class="n">hidden_features</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">num_transforms</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
We will use <code>SNPE</code> with a <code>simulation_batch_size=10</code>, i.e. <code>10</code> simulations will be passed to the simulator which will then handle the simulations in a vectorized way (note that your simulator has to support this in order to use this feature):
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="codehilite"><pre><span></span><code><span class="n">inference</span> <span class="o">=</span> <span class="n">SNPE</span><span class="p">(</span><span class="n">simulator</span><span class="p">,</span> <span class="n">prior</span><span class="p">,</span> <span class="n">x_shape</span><span class="p">,</span> <span class="n">density_estimator</span><span class="o">=</span><span class="n">my_density_estimator</span><span class="p">,</span> 
                 <span class="n">show_progress_bars</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
And we can run inference. In this example, we will run inference over <code>2</code> rounds, potentially leading to a more focused posterior around the observation <code>x_o</code>.
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="codehilite"><pre><span></span><code><span class="n">x_o</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,)</span>
<span class="n">posterior</span> <span class="o">=</span> <span class="n">inference</span><span class="p">(</span><span class="n">num_rounds</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">x_o</span><span class="o">=</span><span class="n">x_o</span><span class="p">,</span> <span class="n">num_simulations_per_round</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">
<div class="output_area" markdown="1">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Neural network successfully converged after 94 epochs.
Neural network successfully converged after 32 epochs.
</pre>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
 Note that, for <code>num_rounds&gt;1</code>, the posterior is no longer amortized: it will give good results when sampled around <code>x=observation</code>, but possibly bad results for other <code>x</code>.
</div>
</div></p>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
Once we have obtained the posterior, we can <code>.sample()</code>, <code>.log_prob()</code>, or <code>.pairplot()</code> in the same way as for the easy interface.
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="codehilite"><pre><span></span><code><span class="n">posterior_samples</span> <span class="o">=</span> <span class="n">posterior</span><span class="o">.</span><span class="n">sample</span><span class="p">((</span><span class="mi">10000</span><span class="p">,),</span> <span class="n">x</span><span class="o">=</span><span class="n">x_o</span><span class="p">)</span>

<span class="c1"># plot posterior samples</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">posterior_samples</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span> 
                   <span class="n">fig_size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
</code></pre></div>
</div>
<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">
<div class="output_area" markdown="1">
<div class="output_png output_subarea">
<img src="data:image/png;base64,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
"/>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<p><div class="inner_cell" markdown="1">
<div class="text_cell_render border-box-sizing rendered_html" markdown="1">
We can always print the posterior to know how it was trained:
</div>
</div></p>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
</div>
</div>
<div class="codehilite"><pre><span></span><code><span class="nb">print</span><span class="p">(</span><span class="n">posterior</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="output_wrapper" markdown="1">
<div class="output" markdown="1">
<div class="output_area" markdown="1">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Posterior conditional density p(θ|x) focused at x_o=[[0.0, 0.0, 0.0]]  with default evaluation at x=[[0.0, 0.0, 0.0]].

This neural posterior was obtained with a SNPE-class method using a flow.
</pre>
</div>
</div>
</div>
</div>




<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" rel="noopener" target="_blank">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs</a>
</div>
<div class="md-footer-social">
<link href="../../../assets/fonts/font-awesome.css" rel="stylesheet"/>
<a class="md-footer-social__link fa fa-" href="https://github.com/mackelab/sbi" rel="noopener" target="_blank" title=""></a>
</div>
</div>
</div>
</footer>

<script src="../../../assets/javascripts/application.c33a9706.js"></script>
<script>app.initialize({version:"1.1",url:{base:"../../.."}})</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>

